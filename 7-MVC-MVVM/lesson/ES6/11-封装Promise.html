<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
	</head>
	<body>
		<script type="text/javascript">
			const getJSON = function(url) {
				const promise = new Promise(function(resolve, reject) {
					const handler = function() {
						if (this.readyState !== 4) {
							return;
						}
						if (this.status === 200) {
							resolve(this.response);
						} else {
							reject(new Error(this.statusText));
						}
					};
					const ajax = new XMLHttpRequest();
					ajax.open("GET", url);
					ajax.onreadystatechange = handler;
					ajax.send();
				});
				return promise;
			};
			// 股票名称
			getJSON("/stock/name", { keyword: "腾讯" })
				.then(function(res) {
					let { name } = res;
					// 股票代码
					return getJSON("/stock/code", { name })
				})
				.then(function(res) {
					let { code } = res;
					// 股票价格
					return getJSON("/stock/price", { code })
				})
				.then(function(res) {
					let { price } = res;
					console.log('股票价格：' + price);
				});
		</script>
	</body>
</html>

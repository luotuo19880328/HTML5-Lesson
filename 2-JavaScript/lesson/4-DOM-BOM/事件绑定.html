<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<style>
			.box {
				position: absolute;
				width: 100px;
				height: 100px;
				border: 1px solid #0000FF;
			}
		</style>
	</head>
	<body>
		<div class="box"></div>
		<button id="btn" type="button">移除事件</button>
		<p>
			<button onclick="changeColor('yellow')" type="button">背景变黄</button>
			<button onclick="changeColor('red')" type="button">背景变红</button>
			<button onclick="changeColor('black')" type="button">背景变黑</button>
		</p>
		<script>
			// 查找元素
			var oBox = document.querySelector(".box");
			var oBtn = document.getElementById("btn");

			function changeColor(color) {
				document.body.style.backgroundColor = color;
			}
			// mousedown
			oBox.onmousedown = function(e) {
				// 记录旧位置的(x0,y0)
				var sx = e.pageX;
				var sy = e.pageY;
				// 旧位置的left,top
				var top = this.offsetTop;
				var left = this.offsetLeft;

				document.onmousemove = function(e) {
					var dx = e.pageX;
					var dy = e.pageY;
					// 计算移动距离
					var distanceX = dx - sx;
					var distanceY = dy - sy;
					// 修改定位left,top
					oBox.style.left = left + distanceX + 'px';
					oBox.style.top = top + distanceY + 'px';
				}
			}
			// 移除事件
			document.onmouseup = function() {
				document.onmousemove = null;
			}
			// 绑定事件
			oBox.onmouseover = function() {
				this.style.backgroundColor = "red";
			}
			oBox.onmouseout = function() {
				this.style.backgroundColor = "white";
			}
			// 移除事件
			oBtn.onclick = function() {
				oBox.onmouseover = null;
				oBox.onmouseout = null;
			}
		</script>
	</body>
</html>
